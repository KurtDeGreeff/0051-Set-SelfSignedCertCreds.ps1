.EXAMPLE
[WITH the -ExportCert switch parameter]
.\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -ExportCert -Verbose
In this example, a new self-signed certificate will be created and installed. The service account password for the service account name specified will be encrypted and exported to a file share, along with the username.
The certificate will also be exported, then removed from the current machine. The verbose switch is added to show details of certain operations.
NOTE: If you are using VSCode to run this script, use this expression to dot source the script so that the variables will be available in your session after the script executes.
. .\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -ExportCert -Verbose

.EXAMPLE
[WITHOUT the -ExportCert switch parameter]
.\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -Verbose
This command will import the self-signed certificate associated with the service account name if required on a machine, retrieve the previously exported credentials, 
then use the certificate to decrypt the password component of the credential.
NOTE: If you are using VSCode to run this script, use this expression to dot source the script so that the variables will be available in your session after the script executes.
. .\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -Verbose

.EXAMPLE
.\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -SuppressPrompts -Verbose
This command will import the self-signed certificate if required on a machine, retrieve the previously exported credentials assoicated with the service account name specified, 
then use the certificate to decrypt the password component of the credential. In this case, all interactive prompts will be suppressed, but transcript logging will continue.
This switch is intended for non-interactive scenarios such as dot sourcing this script from another in order to retrieve the service account credential set for use in the main script.
NOTE: If you are using VSCode to run this script, use this expression to dot source the script so that the variables will be available in your session after the script executes.
. .\Set-SelfSignedCertCreds.ps1 -netDirectory "\\azrfil1001.dev.adatum.com\CertEncryption" -logDirectory "\\azrfil1001.dev.adatum.com\logs" -svcAccountName "svc.ps.script" -SuppressPrompts -Verbose

#region INTEGRATION TESTING - MANUAL
<#
    Manual integration test suite:
    NOTE: If you are using VSCode to run this script, dot source the script so that the variables will be available in your sesssion after the script executes.

    # Test parameters
    # TASK-ITEM: Update these parameters with your own custom values for your environment.
    $remoteTestMachine = "azrads1003.dev.adatum.com"
    $scriptContent = "Get-ChildItem -Path 'c:\'"
    $scriptPath = "F:\OneDrive\02.00.00.GENERAL\repos\0000-scripts\0050\Set-CredTest.ps1"

	# Test case 1.0: To test a command interactively, use the following expression:
    # tc1.1 Interactive command test
    Invoke-Command -Computername $remoteTestMachine -ScriptBlock { Get-Childitem -Path "c:\" } -Credential $svcAccountCred

	# Test case 2.0: Register scheduled job using a script file, which contains the code: Get-ChildItem -Path "c:\" 
    # tc2.1 Register the job using the script file
    Register-ScheduledJob -Name psjob1 -FilePath $scriptPath -Credential $svcAccountCred
    # tc2.2 Create a trigger for 10 seconds from now
    $trigger1 = New-JobTrigger -At (Get-Date).AddSeconds(10) -Once -Verbose
    # t2.3 Add the trigger to the job
    Add-JobTrigger -Name psjob1 -Trigger $trigger1 -Verbose
    # t2.4 After 20 seconds, get the job information.
    Start-Sleep -seconds 20 -Verbose
    Get-ScheduledJob -Name psjob1 -Verbose
    # t2.5 Retieve the results
    Receive-Job -Name psjob1 -Keep -Verbose
    # t2.6 The scheduled jobs will appear at in the Task Scheduler at the path: Microsoft\Windows\PowerShell\ScheduledJobs
    # t2.7 Remove the job 
    Get-ScheduledJob -Name psjob1 | Unregister-ScheduledJob -Verbose

    # Test case 3.0: Register scheduled job using a script block  
    # t3.1 Register scheduled job
    Register-ScheduledJob -Name psjob2 -ScriptBlock { Get-ChildItem -Path "\\azrads1003.dev.adatum.com\c$" } -Credential $svcAccountCred -Verbose
    # t3.2 Create a trigger for 10 seconds from now
    $trigger = New-JobTrigger -At (Get-Date).AddSeconds(10) -Once -Verbose
    # t3.3 Add the trigger to the job
    Add-JobTrigger -Name psjob2 -Trigger $trigger -Verbose
    # t3.4 After 20 seconds, get the job information.
    Start-Sleep -seconds 20 -Verbose
    Get-ScheduledJob -Name psjob2 -Verbose
    # t3.5 Retieve the results
    Receive-Job -Name psjob2 -Keep -Verbose
    # t3.6 The scheduled jobs will appear at in the Task Scheduler at the path: Microsoft\Windows\PowerShell\ScheduledJobs
    # t3.6 Remove the job 
    Get-ScheduledJob -Name psjob2 | Unregister-ScheduledJob -Verbose

    # c1.0 Cleanup and reset test environment. Verify that all jobs have been removed to prepare for subsequent testing.
    # c1.1 Show scheduled jobs if available 
    Get-ScheduledJob -ErrorAction "SilentlyContinue" -Verbose
    
    # c2.0 To remove the currently installed certificate for re-testing the -ExportCert scenario, run the following command:
    # c2.1 Remove install self-signed certificates
    Get-ChildItem -Path $SelfSignedCertParams.CertStoreLocation | Where-Object { $_.Subject -match "-PSScriptCipherCert" } | Remove-Item -Force
#>
#endregion INTEGRATION TESTING - MANUAL